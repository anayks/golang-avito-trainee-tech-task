# golang-backend-trainee-chat-service

Сервис, разработанный на языке Golang, для обработки чатов

## Принципы сервиса

Сервис с чатами оперирует 3 сущностями:
- Пользователи
- Чаты
- Сообщений

Сначала создается пользователь. 
После пользователя создается чат из нескольких пользователей.
После этого пользователи в чате могут обмениваться своими сообщениям.

## Запуск приложения:

```
	docker-compose up
```

Приложение будет доступно на порту 9000

## Основные API методы

Методы обрабатывают HTTP POST запросы c телом, содержащим все необходимые параметры в JSON.

### Добавить нового пользователя

Запрос:

```bash
	curl --header "Content-Type: application/json" \
  --request POST \
  --data '{"username": "user_1"}' \
  http://localhost:9000/users/add
```

Ответ: `id` созданного пользователя или HTTP-код ошибки + описание ошибки.

### Создать новый чат между пользователями

Запрос:

```bash
curl --header "Content-Type: application/json" \
  --request POST \
  --data '{"name": "chat_1", "users": ["<USER_ID_1>", "<USER_ID_2>"]}' \
  http://localhost:9000/chats/add
```

Ответ: `id` созданного чата или HTTP-код ошибки или HTTP-код ошибки + описание ошибки.

Количество пользователей в чате не ограничено.

### Отправить сообщение в чат от лица пользователя

Запрос:

```bash
curl --header "Content-Type: application/json" \
  --request POST \
  --data '{"chat": "<CHAT_ID>", "author": "<USER_ID>", "text": "hi"}' \
  http://localhost:9000/messages/add
```

Ответ: `id` созданного сообщения или HTTP-код ошибки + описание ошибки.

### Получить список чатов конкретного пользователя

Запрос:

```bash
curl --header "Content-Type: application/json" \
  --request POST \
  --data '{"user": "<USER_ID>"}' \
  http://localhost:9000/chats/get
```

Ответ: cписок всех чатов со всеми полями, отсортированный по времени создания последнего сообщения в чате (от позднего к раннему). Или HTTP-код ошибки + описание ошибки.

### Получить список сообщений в конкретном чате

Запрос:

```bash
curl --header "Content-Type: application/json" \
  --request POST \
  --data '{"chat": "<CHAT_ID>"}' \
  http://localhost:9000/messages/get
```

Ответ: список всех сообщений чата со всеми полями, отсортированный по времени создания сообщения (от раннего к позднему). Или HTTP-код ошибки + описание ошибки.

## Детали реализации:
- [x] Язык программирования - Golang
- [x]	Хранилище (СУБД) - PostgreSQL
- [x] При перезапуске сервера добавленные данные должны сохраняться
- [x] Сервер должен быть доступен на порту 9000
- [x] Основной API, указанный в задании
- [x] Предоставить инструкцию по запуску приложения. В идеале (но не обязательно) – использовать контейнеризацию с возможностью запустить проект командой `docker-compose up`
- [x] Финальную версию нужно выложить на github.com
- [x] Все данные возвращаются в представлении JSON

## Дополнительно:
- [x] Написаны тесты (постарайтесь достичь покрытия в 70% и больше)
- [x]	Добавлена валидация имен юзеров, чатов и сообщений
- [x]	Все запросы оптимизированы так, чтобы не было Seq Scan'ов
- [ ] Проведено нагрузочное тестирование с целью понять, какую нагрузку на чтение может выдержать наш сервис

## References
(Задание)(https://github.com/avito-tech/auto-backend-trainee-assignment)